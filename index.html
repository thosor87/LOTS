<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOTS | LexOffice Time Scheduling</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://www.lilapixel.de/images/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.lilapixel.de/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.lilapixel.de/images/favicon/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://www.lilapixel.de/images/favicon/apple-touch-icon.png">

    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Auth Screen (shown when not logged in) -->
    <div id="authScreen" class="auth-screen">
        <button class="btn btn-small btn-secondary" onclick="toggleDarkMode()" id="darkModeToggleAuth" title="Dark Mode umschalten" style="position: absolute; top: 20px; right: 20px;">
            <span id="darkModeIconAuth">üåô</span>
        </button>
        <div class="auth-container">
            <div class="auth-logo">
                <span class="logo-icon">‚óÜ</span>
                <span class="logo-text">LOTS</span>
            </div>
            <h2>LexOffice Time Scheduling</h2>

            <!-- Login/Register Form -->
            <div id="loginForm" class="auth-form">
                <h3>Mit Google anmelden</h3>

                <button class="btn btn-google" onclick="signInWithGoogle()">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
                        <path d="M9.003 18c2.43 0 4.467-.806 5.956-2.18L12.05 13.56c-.806.54-1.836.86-3.047.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9.003 18z" fill="#34A853"/>
                        <path d="M3.964 10.71c-.18-.54-.282-1.117-.282-1.71s.102-1.17.282-1.71V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/>
                        <path d="M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.426 0 9.003 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29c.708-2.127 2.692-3.71 5.036-3.71z" fill="#EA4335"/>
                    </svg>
                    Mit Google anmelden
                </button>
            </div>

            <!-- Organization Setup (shown after first login) -->
            <div id="orgSetupForm" class="auth-form" style="display: none;">
                <h3>Organisation einrichten</h3>
                <p>M√∂chtest du eine neue Organisation erstellen oder einer bestehenden beitreten?</p>

                <button class="btn btn-primary" onclick="createOrganization()">Neue Organisation erstellen</button>

                <div class="auth-divider">
                    <span>oder</span>
                </div>

                <form onsubmit="joinOrganization(event)">
                    <div class="form-group">
                        <label for="inviteCode">Einladungscode</label>
                        <input type="text" id="inviteCode" required placeholder="z.B. FIRM-2K8X" style="text-transform: uppercase;">
                    </div>
                    <button type="submit" class="btn btn-secondary">Organisation beitreten</button>
                </form>
            </div>

        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo" onclick="scrollToTop()">
                <span class="logo-icon">‚óÜ</span>
                <span class="logo-text">LOTS</span>
            </div>

            <!-- Burger Menu Button (mobile only) -->
            <button class="burger-menu" onclick="toggleMobileMenu()" aria-label="Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <nav class="nav" id="mobileNav">
                <a href="#zeiterfassung" class="nav-link active" onclick="closeMobileMenu()">Zeiterfassung</a>
                <a href="#kunden" class="nav-link" onclick="closeMobileMenu()">Kunden</a>
                <a href="#projekte" class="nav-link" onclick="closeMobileMenu()">Projekte</a>
                <a href="#auswertung" class="nav-link" onclick="closeMobileMenu()">Auswertung</a>
                <a href="#export" class="nav-link" onclick="closeMobileMenu()">Export</a>

                <!-- Mobile User Section (shown in mobile nav) -->
                <div class="mobile-user-section">
                    <div class="mobile-user-info">
                        <div class="user-avatar">üë§</div>
                        <div class="user-details">
                            <span id="currentUserNameMobile" class="user-name-mobile"></span>
                            <span id="orgNameMobile" class="org-name-mobile"></span>
                        </div>
                    </div>
                    <div class="mobile-actions">
                        <button class="mobile-action-btn" onclick="toggleDarkMode(); closeMobileMenu();" title="Dark Mode">
                            <span id="darkModeIconMobile">üåô</span>
                        </button>
                        <button class="mobile-action-btn" onclick="showOrgSettings(); closeMobileMenu();" title="Einstellungen">
                            ‚öôÔ∏è
                        </button>
                        <button class="mobile-action-btn logout" onclick="signOut()" title="Abmelden">
                            üö™
                        </button>
                    </div>
                </div>
            </nav>

            <div class="user-menu desktop-only">
                <div id="userInfo" class="user-info">
                    <span id="currentUserName" class="user-name"></span>
                    <span id="orgName" class="org-name"></span>
                </div>
                <button class="btn btn-small btn-secondary" onclick="toggleDarkMode()" id="darkModeToggle" title="Dark Mode umschalten">
                    <span id="darkModeIcon">üåô</span>
                </button>
                <button class="btn btn-small btn-secondary" onclick="showOrgSettings()">‚öô Einstellungen</button>
                <button class="btn btn-small btn-secondary" onclick="signOut()">Abmelden</button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay" onclick="closeMobileMenu()"></div>

    <!-- Main Content (hidden until logged in) -->
    <div id="appContent" style="display: none;">
    <main class="main">

        <!-- Zeiterfassung Section -->
        <section class="section" id="zeiterfassung">
            <div class="section-header">
                <h2>Zeiterfassung <span class="accent">+</span></h2>
                <p>Erfasse deine Arbeitszeiten schnell und einfach</p>
            </div>

            <div class="time-tracking-wrapper">
                <!-- Left Column: Timer & Quick Access -->
                <div class="time-tracking-sidebar">
                    <!-- Timer -->
                    <div class="timer-card">
                        <div class="timer-display">
                            <span id="timerDisplay">00:00:00</span>
                        </div>
                        <div class="timer-controls">
                            <button class="btn btn-primary btn-large" id="startStopBtn" onclick="toggleTimer()">
                                <span id="timerBtnText">‚ñ∂ Start</span>
                            </button>
                            <button class="btn btn-secondary" onclick="resetTimer()">‚Ü∫ Reset</button>
                        </div>
                    </div>

                    <!-- Quick Access -->
                    <div class="quick-access-card">
                        <h3>Zuletzt verwendet</h3>
                        <div id="recentProjects" class="recent-projects">
                            <p class="empty-state-small">Noch keine Eintr√§ge</p>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Manual Entry Form -->
                <div class="time-entry-form">
                    <h3>Zeiteintrag erstellen</h3>
                    <form id="timeEntryForm" onsubmit="saveTimeEntry(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="entryDate">Datum</label>
                                <input type="date" id="entryDate" required>
                            </div>
                            <div class="form-group">
                                <label for="entryStartTime">Startzeit</label>
                                <input type="time" id="entryStartTime">
                            </div>
                            <div class="form-group">
                                <label for="entryEndTime">Endzeit</label>
                                <input type="time" id="entryEndTime">
                            </div>
                            <div class="form-group">
                                <label for="entryDuration">Dauer (Stunden)</label>
                                <input type="number" id="entryDuration" step="any" min="0" placeholder="z.B. 2.5">
                                <small>Optional: z.B. 2.5 f√ºr 2h 30min</small>
                            </div>
                            <div class="form-group">
                                <label for="entryClient">Kunde</label>
                                <select id="entryClient" required onchange="loadProjectsForClient(this.value)">
                                    <option value="">Kunde w√§hlen...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="entryProject">Projekt</label>
                                <select id="entryProject" required>
                                    <option value="">Projekt w√§hlen...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="entryTags">Tags (Stichworte)</label>
                                <input type="text" id="entryTags" list="tagsSuggestions" placeholder="z.B. meeting, design, review">
                                <datalist id="tagsSuggestions"></datalist>
                                <small>Kommagetrennte Stichworte</small>
                            </div>
                            <div class="form-group full-width">
                                <label for="entryDescription">Beschreibung</label>
                                <textarea id="entryDescription" rows="2" placeholder="Was hast du gemacht?"></textarea>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">+ Eintrag speichern</button>
                    </form>
                </div>
            </div>

            <!-- Aktuelle Eintr√§ge -->
            <div class="entries-list">
                <div class="entries-header">
                    <h3>Heutige Eintr√§ge</h3>
                    <div class="view-toggle">
                        <button class="btn btn-small btn-secondary active" id="listViewBtn" onclick="switchTodayView('list')">
                            ‚â° Liste
                        </button>
                        <button class="btn btn-small btn-secondary" id="calendarViewBtn" onclick="switchTodayView('calendar')">
                            üìÖ Kalender
                        </button>
                    </div>
                </div>
                <div id="todayEntries" class="entries-container">
                    <p class="empty-state">Noch keine Eintr√§ge f√ºr heute ‚ú¶</p>
                </div>
                <div id="todayCalendar" class="calendar-timeline" style="display: none;">
                    <p class="empty-state">Noch keine Eintr√§ge f√ºr heute ‚ú¶</p>
                </div>
            </div>
        </section>

        <!-- Kunden Section -->
        <section class="section" id="kunden">
            <div class="section-header">
                <h2>Kundenverwaltung <span class="accent">‚óÜ</span></h2>
                <p>Verwalte deine Kunden und deren Kontaktdaten</p>
            </div>

            <button class="btn btn-primary" onclick="openClientModal()">+ Neuer Kunde</button>

            <div class="cards-grid" id="clientsList">
                <p class="empty-state">Noch keine Kunden angelegt ‚óâ</p>
            </div>
        </section>

        <!-- Projekte Section -->
        <section class="section" id="projekte">
            <div class="section-header">
                <h2>Projektverwaltung <span class="accent">‚ú¶</span></h2>
                <p>Organisiere deine Projekte nach Kunden</p>
            </div>

            <button class="btn btn-primary" onclick="openProjectModal()">+ Neues Projekt</button>

            <div class="cards-grid" id="projectsList">
                <p class="empty-state">Noch keine Projekte angelegt ‚ú¶</p>
            </div>
        </section>

        <!-- Auswertung Section -->
        <section class="section" id="auswertung">
            <div class="section-header">
                <h2>Auswertungen <span class="accent">‚óâ</span></h2>
                <p>Analysiere deine Arbeitszeiten mit interaktiven Grafiken</p>
            </div>

            <!-- Filter -->
            <div class="filter-bar">
                <div class="filter-group">
                    <label>Zeitraum:</label>
                    <select id="filterPeriod" onchange="handlePeriodChange()">
                        <option value="custom">Benutzerdefiniert</option>
                        <option value="current-month">Aktueller Monat</option>
                        <option value="last-month">Letzter Monat</option>
                    </select>
                    <input type="date" id="filterStartDate" onchange="updateCharts()">
                    <span>bis</span>
                    <input type="date" id="filterEndDate" onchange="updateCharts()">
                </div>
                <div class="filter-group">
                    <label>Kunde:</label>
                    <select id="filterClient" onchange="updateCharts()">
                        <option value="">Alle Kunden</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Projekt:</label>
                    <select id="filterProject" onchange="updateCharts()">
                        <option value="">Alle Projekte</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Tag:</label>
                    <select id="filterTag" onchange="updateCharts()">
                        <option value="">Alle Tags</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Benutzer:</label>
                    <select id="filterUser" onchange="updateCharts()">
                        <option value="">Alle Benutzer</option>
                    </select>
                </div>
                <button class="btn btn-small btn-secondary" onclick="clearAllFilters()" title="Alle Filter zur√ºcksetzen">
                    ‚úï Alle Filter l√∂schen
                </button>
            </div>

            <!-- Charts Grid -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h3>Stunden pro Kunde</h3>
                    <canvas id="clientChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Stunden pro Projekt</h3>
                    <canvas id="projectChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Stunden pro Tag (Wochen√ºbersicht)</h3>
                    <canvas id="dailyChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Monatlicher Verlauf</h3>
                    <canvas id="monthlyChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Verteilung nach Tags</h3>
                    <canvas id="tagChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Stunden pro Benutzer</h3>
                    <canvas id="userChart"></canvas>
                </div>
            </div>

            <!-- Detailtabelle -->
            <div class="detail-table-container">
                <div class="entries-header">
                    <h3>Detaillierte Auflistung</h3>
                    <div class="view-toggle">
                        <button class="btn btn-small btn-secondary active" id="detailTableViewBtn" onclick="switchDetailView('table')">
                            ‚â° Tabelle
                        </button>
                        <button class="btn btn-small btn-secondary" id="detailMonthViewBtn" onclick="switchDetailView('month')">
                            üìÖ Monat
                        </button>
                        <button class="btn btn-small btn-secondary" id="detailWeekViewBtn" onclick="switchDetailView('week')">
                            üìä Woche
                        </button>
                    </div>
                </div>
                <div id="detailTableView">
                    <table class="detail-table" id="detailTable">
                        <thead>
                            <tr>
                                <th>Datum</th>
                                <th>Benutzer</th>
                                <th>Kunde</th>
                                <th>Projekt</th>
                                <th>Beschreibung</th>
                                <th>Tags</th>
                                <th>Dauer</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="detailTableBody">
                        </tbody>
                    </table>
                </div>
                <div id="detailMonthView" class="calendar-month-view" style="display: none;">
                    <!-- Month calendar will be rendered here -->
                </div>
                <div id="detailWeekView" class="calendar-week-view" style="display: none;">
                    <!-- Week timeline will be rendered here -->
                </div>
            </div>
        </section>

        <!-- Export Section -->
        <section class="section" id="export">
            <div class="section-header">
                <h2>Export <span class="accent">+</span></h2>
                <p>Exportiere deine Zeitdaten als CSV oder PDF</p>
            </div>

            <div class="export-options">
                <div class="export-card">
                    <div class="export-icon">üìä</div>
                    <h3>CSV Export</h3>
                    <p>F√ºr Excel, Google Sheets oder andere Tabellenkalkulationen</p>
                    <div class="export-filters">
                        <select id="csvExportClient">
                            <option value="">Alle Kunden</option>
                        </select>
                        <select id="csvExportProject">
                            <option value="">Alle Projekte</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="exportCSV()">‚Üì CSV herunterladen</button>
                </div>

                <div class="export-card">
                    <div class="export-icon">üìÑ</div>
                    <h3>PDF Bericht</h3>
                    <p>Professioneller Bericht f√ºr interne Zwecke</p>
                    <div class="export-filters">
                        <select id="pdfExportClient">
                            <option value="">Alle Kunden</option>
                        </select>
                        <select id="pdfExportProject">
                            <option value="">Alle Projekte</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="exportPDF('internal')">‚Üì PDF herunterladen</button>
                </div>

                <div class="export-card highlight">
                    <div class="export-icon">üì®</div>
                    <h3>Kunden-PDF</h3>
                    <p>Aufbereiteter Bericht zum Versenden an Kunden</p>
                    <div class="export-filters">
                        <select id="customerPdfClient" required>
                            <option value="">Kunde w√§hlen...</option>
                        </select>
                        <select id="customerPdfProject">
                            <option value="">Alle Projekte des Kunden</option>
                        </select>
                        <input type="month" id="customerPdfMonth">
                    </div>
                    <label class="checkbox-label">
                        <input type="checkbox" id="includeDetails" checked>
                        Detaillierte Auflistung einschlie√üen
                    </label>
                    <button class="btn btn-accent" onclick="exportPDF('customer')">‚Üì Kunden-PDF erstellen</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <span class="logo-icon">‚óÜ</span> LOTS
            </div>
            <p>Self-Made with ü§ç and AI by
                <a href="https://lilapixel.de" target="_blank" rel="noopener noreferrer" class="lilapixel-link">
                    <img src="https://drat580elycl3.cloudfront.net/images/LP_Logo.png" alt="LILAPIXEL Grafikdesign" class="lilapixel-logo">
                </a>
            </p>
            <p class="footer-note">Daten werden sicher in der Cloud gespeichert (Firebase)</p>
            <p class="footer-links">
                <a href="https://www.lilapixel.de/impressum.html" target="_blank" rel="noopener noreferrer">Impressum</a>
            </p>
        </div>
    </footer>
    </div>
    <!-- End appContent -->

    <!-- Modals -->
    <!-- Client Modal -->
    <div class="modal" id="clientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="clientModalTitle">Neuer Kunde</h3>
                <button class="modal-close" onclick="closeModal('clientModal')">√ó</button>
            </div>
            <form id="clientForm" onsubmit="saveClient(event)">
                <input type="hidden" id="editClientId">
                <div class="form-group">
                    <label for="clientName">Firmenname *</label>
                    <input type="text" id="clientName" required>
                </div>
                <div class="form-group">
                    <label for="clientContact">Ansprechpartner</label>
                    <input type="text" id="clientContact">
                </div>
                <div class="form-group">
                    <label for="clientEmail">E-Mail</label>
                    <input type="email" id="clientEmail">
                </div>
                <div class="form-group">
                    <label for="clientPhone">Telefon</label>
                    <input type="tel" id="clientPhone">
                </div>
                <div class="form-group">
                    <label for="clientAddress">Adresse</label>
                    <textarea id="clientAddress" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label for="clientHourlyRate">Stundensatz (‚Ç¨)</label>
                    <input type="number" id="clientHourlyRate" step="0.01" min="0">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('clientModal')">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Speichern</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Project Modal -->
    <div class="modal" id="projectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="projectModalTitle">Neues Projekt</h3>
                <button class="modal-close" onclick="closeModal('projectModal')">√ó</button>
            </div>
            <form id="projectForm" onsubmit="saveProject(event)">
                <input type="hidden" id="editProjectId">
                <div class="form-group">
                    <label for="projectClient">Kunde *</label>
                    <select id="projectClient" required>
                        <option value="">Kunde w√§hlen...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="projectName">Projektname *</label>
                    <input type="text" id="projectName" required>
                </div>
                <div class="form-group">
                    <label for="projectDescription">Beschreibung</label>
                    <textarea id="projectDescription" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label for="projectBudgetHours">Budget (Stunden)</label>
                    <input type="number" id="projectBudgetHours" min="0" step="0.5">
                </div>
                <div class="form-group">
                    <label for="projectHourlyRate">Stundensatz (‚Ç¨)</label>
                    <input type="number" id="projectHourlyRate" min="0" step="0.01" placeholder="Optional: √ºberschreibt Kunden-Stundensatz">
                    <small>Leer lassen f√ºr Kunden-Stundensatz</small>
                </div>
                <div class="form-group">
                    <label for="projectDeadline">Deadline</label>
                    <input type="date" id="projectDeadline">
                </div>
                <div class="form-group">
                    <label for="projectStatus">Status</label>
                    <select id="projectStatus">
                        <option value="active">Aktiv</option>
                        <option value="paused">Pausiert</option>
                        <option value="completed">Abgeschlossen</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="projectMinInterval">Mindestintervall</label>
                    <select id="projectMinInterval">
                        <option value="15">15 Minuten</option>
                        <option value="30">30 Minuten</option>
                        <option value="60">60 Minuten</option>
                    </select>
                    <small>Zeiteintr√§ge werden automatisch auf dieses Intervall aufgerundet</small>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('projectModal')">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Speichern</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Neuer Benutzer</h3>
                <button class="modal-close" onclick="closeModal('userModal')">√ó</button>
            </div>
            <form id="userForm" onsubmit="saveUser(event)">
                <div class="form-group">
                    <label for="userName">Name *</label>
                    <input type="text" id="userName" required>
                </div>
                <div class="form-group">
                    <label for="userEmail">E-Mail</label>
                    <input type="email" id="userEmail">
                </div>
                <div class="form-group">
                    <label for="userColor">Farbe (f√ºr Charts)</label>
                    <input type="color" id="userColor" value="#9B59B6">
                </div>
                <p class="form-note">Maximal 5 Benutzer m√∂glich</p>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('userModal')">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Speichern</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Organization Settings Modal -->
    <div class="modal" id="orgSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Organisations-Einstellungen</h3>
                <button class="modal-close" onclick="closeModal('orgSettingsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="org-info">
                    <h4>Organisation</h4>
                    <p id="orgSettingsName" class="org-detail"></p>
                    <button class="btn btn-danger btn-small" onclick="leaveOrganization()" style="margin-bottom: 1.5rem;">Organisation verlassen</button>

                    <h4>Einladungscode</h4>
                    <div class="invite-code-display">
                        <code id="inviteCodeDisplay" class="invite-code"></code>
                        <button class="btn btn-small btn-secondary" onclick="copyInviteCode()">Kopieren</button>
                    </div>
                    <p class="form-note">Teile diesen Code mit Kollegen, damit sie beitreten k√∂nnen.</p>

                    <h4>Mitglieder</h4>
                    <ul id="orgMembersList" class="members-list"></ul>

                    <h4>Meine Einstellungen</h4>
                    <div class="user-settings">
                        <div class="form-group">
                            <label for="userColorSetting">Meine Farbe (f√ºr Charts und Anzeige)</label>
                            <input type="color" id="userColorSetting">
                        </div>
                        <button class="btn btn-primary btn-small" onclick="saveUserColor()">Farbe speichern</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Entry Modal -->
    <div class="modal" id="editEntryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Eintrag bearbeiten</h3>
                <button class="modal-close" onclick="closeModal('editEntryModal')">√ó</button>
            </div>
            <form id="editEntryForm" onsubmit="updateTimeEntry(event)">
                <input type="hidden" id="editEntryId">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="editEntryDate">Datum</label>
                        <input type="date" id="editEntryDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editEntryStartTime">Startzeit</label>
                        <input type="time" id="editEntryStartTime">
                    </div>
                    <div class="form-group">
                        <label for="editEntryEndTime">Endzeit</label>
                        <input type="time" id="editEntryEndTime">
                    </div>
                    <div class="form-group">
                        <label for="editEntryDuration">Dauer (Stunden)</label>
                        <input type="number" id="editEntryDuration" step="any" min="0" placeholder="z.B. 2.5" readonly>
                        <small>Wird automatisch aus Start- und Endzeit berechnet</small>
                    </div>
                    <div class="form-group">
                        <label for="editEntryClient">Kunde</label>
                        <select id="editEntryClient" required onchange="loadProjectsForClientEdit(this.value)">
                            <option value="">Kunde w√§hlen...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editEntryProject">Projekt</label>
                        <select id="editEntryProject" required>
                            <option value="">Projekt w√§hlen...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editEntryTags">Tags</label>
                        <input type="text" id="editEntryTags" list="tagsSuggestions" placeholder="z.B. meeting, design">
                    </div>
                    <div class="form-group full-width">
                        <label for="editEntryDescription">Beschreibung</label>
                        <textarea id="editEntryDescription" rows="2"></textarea>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('editEntryModal')">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Aktualisieren</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
